<div class="exercise-container">
  <div class="header">
    <h1>Exercise Library</h1>
  </div>

  <mat-card class="search-card">
    <mat-card-content>
      <div class="search-form">
        <mat-form-field appearance="fill" class="search-input">
          <mat-label>Search exercises</mat-label>
          <input matInput [(ngModel)]="searchQuery" (keyup.enter)="searchExercises()">
          <button *ngIf="searchQuery" matSuffix mat-icon-button aria-label="Clear" (click)="searchQuery = ''; searchExercises()">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>

        <button mat-raised-button color="primary" (click)="searchExercises()">
          <mat-icon>search</mat-icon>
          Search
        </button>
      </div>

      <div class="muscle-filters">
        <span class="filter-label">Filter by muscle:</span>
        <mat-chip-listbox [multiple]="false" (change)="onMuscleFilterChange($event)">
          <mat-chip-option value="all" [selected]="selectedMuscle === 'all'">All</mat-chip-option>
          <mat-chip-option value="chest" [selected]="selectedMuscle === 'chest'">Chest</mat-chip-option>
          <mat-chip-option value="lats" [selected]="selectedMuscle === 'lats'">Lats</mat-chip-option>
          <mat-chip-option value="biceps" [selected]="selectedMuscle === 'biceps'">Biceps</mat-chip-option>
          <mat-chip-option value="triceps" [selected]="selectedMuscle === 'triceps'">Triceps</mat-chip-option>
          <mat-chip-option value="abdominals" [selected]="selectedMuscle === 'abdominals'">Abs</mat-chip-option>
          <mat-chip-option value="quadriceps" [selected]="selectedMuscle === 'quadriceps'">Quads</mat-chip-option>
          <mat-chip-option value="hamstrings" [selected]="selectedMuscle === 'hamstrings'">Hamstrings</mat-chip-option>
          <mat-chip-option value="glutes" [selected]="selectedMuscle === 'glutes'">Glutes</mat-chip-option>
          <mat-chip-option value="shoulders" [selected]="selectedMuscle === 'shoulders'">Shoulders</mat-chip-option>
        </mat-chip-listbox>
      </div>
    </mat-card-content>
  </mat-card>

  <div *ngIf="loading" class="loading-spinner">
    <mat-spinner></mat-spinner>
  </div>

  <div *ngIf="!loading && exercises.length === 0" class="no-exercises">
    <mat-icon>fitness_center</mat-icon>
    <p>No exercises found. Try a different search term or muscle group.</p>
  </div>

  <div *ngIf="!loading && exercises.length > 0" class="exercise-grid">
    <mat-card *ngFor="let exercise of exercises" class="exercise-card">
      <mat-card-header>
        <mat-card-title>{{ exercise.name }}</mat-card-title>
        <mat-card-subtitle>{{ exercise.primaryMuscles?.join(', ') || 'Not specified' }}</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <p><strong>Equipment:</strong> {{ exercise.equipment || 'Not specified' }}</p>
        <p><strong>Level:</strong> {{ exercise.level || 'Not specified' }}</p>
        <p><strong>Primary Muscles:</strong> {{ exercise.primaryMuscles?.join(', ') || 'None' }}</p>
        <p><strong>Secondary Muscles:</strong> {{ exercise.secondaryMuscles?.join(', ') || 'None' }}</p>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button (click)="viewExerciseDetails(exercise)">
          VIEW DETAILS
        </button>
        <button mat-button color="primary" (click)="addToTemplate(exercise)">
          ADD TO TEMPLATE
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
  <div class="pagination-controls" *ngIf="totalExercises > pageSize">
    <button mat-button [disabled]="currentPage === 0" (click)="prevPage()">
      <mat-icon>navigate_before</mat-icon> Previous
    </button>
    <span class="page-info">
    Page {{ currentPage + 1 }} of {{ Math.ceil(totalExercises / pageSize) }}
  </span>
    <button mat-button [disabled]="(currentPage + 1) * pageSize >= totalExercises" (click)="nextPage()">
      Next <mat-icon>navigate_next</mat-icon>
    </button>
  </div>
</div>
